(function(){"use strict";var R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function D(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var x={exports:{}};(function(e){(function(n,o){e.exports?e.exports=o():n.log=o()})(R,function(){var n=function(){},o="undefined",p=typeof window!==o&&typeof window.navigator!==o&&/Trident\/|MSIE /.test(window.navigator.userAgent),y=["trace","debug","info","warn","error"],g={},i=null;function L(r,a){var t=r[a];if(typeof t.bind=="function")return t.bind(r);try{return Function.prototype.bind.call(t,r)}catch{return function(){return Function.prototype.apply.apply(t,[r,arguments])}}}function m(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function E(r){return r==="debug"&&(r="log"),typeof console===o?!1:r==="trace"&&p?m:console[r]!==void 0?L(console,r):console.log!==void 0?L(console,"log"):n}function v(){for(var r=this.getLevel(),a=0;a<y.length;a++){var t=y[a];this[t]=a<r?n:this.methodFactory(t,r,this.name)}if(this.log=this.debug,typeof console===o&&r<this.levels.SILENT)return"No console available for logging"}function T(r){return function(){typeof console!==o&&(v.call(this),this[r].apply(this,arguments))}}function U(r,a,t){return E(r)||T.apply(this,arguments)}function k(r,a){var t=this,A,$,h,u="loglevel";typeof r=="string"?u+=":"+r:typeof r=="symbol"&&(u=void 0);function Y(l){var s=(y[l]||"silent").toUpperCase();if(!(typeof window===o||!u)){try{window.localStorage[u]=s;return}catch{}try{window.document.cookie=encodeURIComponent(u)+"="+s+";"}catch{}}}function O(){var l;if(!(typeof window===o||!u)){try{l=window.localStorage[u]}catch{}if(typeof l===o)try{var s=window.document.cookie,_=encodeURIComponent(u),P=s.indexOf(_+"=");P!==-1&&(l=/^([^;]+)/.exec(s.slice(P+_.length+1))[1])}catch{}return t.levels[l]===void 0&&(l=void 0),l}}function q(){if(!(typeof window===o||!u)){try{window.localStorage.removeItem(u)}catch{}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function F(l){var s=l;if(typeof s=="string"&&t.levels[s.toUpperCase()]!==void 0&&(s=t.levels[s.toUpperCase()]),typeof s=="number"&&s>=0&&s<=t.levels.SILENT)return s;throw new TypeError("log.setLevel() called with invalid level: "+l)}t.name=r,t.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},t.methodFactory=a||U,t.getLevel=function(){return h??$??A},t.setLevel=function(l,s){return h=F(l),s!==!1&&Y(h),v.call(t)},t.setDefaultLevel=function(l){$=F(l),O()||t.setLevel(l,!1)},t.resetLevel=function(){h=null,q(),v.call(t)},t.enableAll=function(l){t.setLevel(t.levels.TRACE,l)},t.disableAll=function(l){t.setLevel(t.levels.SILENT,l)},t.rebuild=function(){if(i!==t&&(A=F(i.getLevel())),v.call(t),i===t)for(var l in g)g[l].rebuild()},A=F(i?i.getLevel():"WARN");var B=O();B!=null&&(h=F(B)),v.call(t)}i=new k,i.getLogger=function(a){if(typeof a!="symbol"&&typeof a!="string"||a==="")throw new TypeError("You must supply a name when creating a logger.");var t=g[a];return t||(t=g[a]=new k(a,i.methodFactory)),t};var S=typeof window!==o?window.log:void 0;return i.noConflict=function(){return typeof window!==o&&window.log===i&&(window.log=S),i},i.getLoggers=function(){return g},i.default=i,i})})(x);var G=x.exports;const c=D(G),M={level:"error",prefix:"[Backlog Enhancement]",timestamp:!0},w={},I=new Map;function N(e){c.setLevel(e)}function b(e,n){const o=I.get(e);o&&o.setLevel(n),w[e]=n}function j(e){return w[e]||"info"}function K(){return{...w}}function W(e){const n=I.get(e);if(n)return n;const o=c.getLogger(e),p=w[e]||"info";o.setLevel(p);const y=o.methodFactory;return o.methodFactory=function(g,i,L){const m=y(g,i,L);return function(...E){const v=`[${new Date().toISOString()}]`,T=`${M.prefix}`,U=`[${g.toUpperCase()}]`,k=`[${e.charAt(0).toUpperCase()+e.slice(1)}]`,S=[`${v} ${T} ${U} ${k}`,...E].filter(Boolean);m(...S)}},o.setLevel(o.getLevel()),I.set(e,o),o}function C(){if(typeof window>"u"||typeof chrome>"u")return!0;try{return window.location.hostname==="localhost"||window.location.hostname.includes("dev")||chrome.runtime.getManifest().version.includes("dev")}catch{return!0}}function z(e){const n=c.methodFactory;c.methodFactory=function(o,p,y){const g=n(o,p,y);return function(...i){const L=e.timestamp?`[${new Date().toISOString()}]`:"",m=e.prefix?`${e.prefix}`:"",E=`[${o.toUpperCase()}]`,v=[`${L} ${m} ${E}`,...i].filter(Boolean);g(...v)}},c.setLevel(c.getLevel())}function V(e){const n={...M,...e};C()?n.level="debug":n.level="warn",z(n),N(n.level),c.info("Logger initialized",{level:n.level,isDev:C()})}function f(e){const n=W(e);return{debug:(...o)=>n.debug(...o),info:(...o)=>n.info(...o),warn:(...o)=>n.warn(...o),error:(...o)=>n.error(...o)}}const d={debug:(...e)=>c.debug(...e),info:(...e)=>c.info(...e),warn:(...e)=>c.warn(...e),error:(...e)=>c.error(...e),boardAccordion:f("boardAccordion"),issuePending:f("issuePending"),shortcutKeys:f("shortcutKeys"),storage:f("storage"),backlog:f("backlog"),background:f("background"),options:f("options"),content:f("content"),popup:f("popup")},J={setLevel:b,getLevel:j,showAll:()=>{console.table(K())},enable:e=>{b(e,"debug"),console.log(`✅ ${e} logging enabled (debug level)`)},disable:e=>{b(e,"silent"),console.log(`❌ ${e} logging disabled`)},enableAll:()=>{Object.keys(w).forEach(e=>{b(e,"debug")}),console.log("✅ All feature logging enabled")},disableAll:()=>{Object.keys(w).forEach(e=>{b(e,"error")}),console.log("❌ All feature logging disabled (error only)")}};typeof window<"u"&&C()&&(window.__backlogLoggerControl__=J),V(),chrome.runtime.onInstalled.addListener(e=>{d.info("Backlog Usability Enhance installed:",e.reason),e.reason==="install"?d.info("First time installation"):e.reason==="update"&&d.info("Extension updated")}),chrome.runtime.onStartup.addListener(()=>{d.info("Backlog Usability Enhance started")}),chrome.runtime.onMessage.addListener((e,n,o)=>{var p;switch(d.debug("Message received in background:",e),(e==null?void 0:e.type)??""){case"GET_TAB_INFO":(p=n.tab)!=null&&p.id&&o({tabId:n.tab.id,url:n.tab.url,title:n.tab.title});break;default:d.warn("Unknown message type:",e==null?void 0:e.type),o({error:"Unknown message type"})}return!0}),chrome.tabs.onUpdated.addListener((e,n,o)=>{n.status==="complete"&&o.url&&(o.url.includes(".backlog.jp")||o.url.includes(".backlog.com"))&&d.info("Backlog page loaded:",o.url)}),chrome.storage.onChanged.addListener((e,n)=>{d.debug("Storage changed:",{changes:e,areaName:n}),n==="sync"&&e.backlog_usability_enhance_settings&&d.info("Settings updated:",e.backlog_usability_enhance_settings.newValue)})})();
