(function(){"use strict";var R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function D(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var x={exports:{}};(function(e){(function(t,o){e.exports?e.exports=o():t.log=o()})(R,function(){var t=function(){},o="undefined",p=typeof window!==o&&typeof window.navigator!==o&&/Trident\/|MSIE /.test(window.navigator.userAgent),y=["trace","debug","info","warn","error"],g={},i=null;function L(r,a){var n=r[a];if(typeof n.bind=="function")return n.bind(r);try{return Function.prototype.bind.call(n,r)}catch{return function(){return Function.prototype.apply.apply(n,[r,arguments])}}}function m(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function E(r){return r==="debug"&&(r="log"),typeof console===o?!1:r==="trace"&&p?m:console[r]!==void 0?L(console,r):console.log!==void 0?L(console,"log"):t}function v(){for(var r=this.getLevel(),a=0;a<y.length;a++){var n=y[a];this[n]=a<r?t:this.methodFactory(n,r,this.name)}if(this.log=this.debug,typeof console===o&&r<this.levels.SILENT)return"No console available for logging"}function T(r){return function(){typeof console!==o&&(v.call(this),this[r].apply(this,arguments))}}function U(r,a,n){return E(r)||T.apply(this,arguments)}function k(r,a){var n=this,A,$,b,u="loglevel";typeof r=="string"?u+=":"+r:typeof r=="symbol"&&(u=void 0);function Y(l){var s=(y[l]||"silent").toUpperCase();if(!(typeof window===o||!u)){try{window.localStorage[u]=s;return}catch{}try{window.document.cookie=encodeURIComponent(u)+"="+s+";"}catch{}}}function O(){var l;if(!(typeof window===o||!u)){try{l=window.localStorage[u]}catch{}if(typeof l===o)try{var s=window.document.cookie,_=encodeURIComponent(u),B=s.indexOf(_+"=");B!==-1&&(l=/^([^;]+)/.exec(s.slice(B+_.length+1))[1])}catch{}return n.levels[l]===void 0&&(l=void 0),l}}function q(){if(!(typeof window===o||!u)){try{window.localStorage.removeItem(u)}catch{}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function F(l){var s=l;if(typeof s=="string"&&n.levels[s.toUpperCase()]!==void 0&&(s=n.levels[s.toUpperCase()]),typeof s=="number"&&s>=0&&s<=n.levels.SILENT)return s;throw new TypeError("log.setLevel() called with invalid level: "+l)}n.name=r,n.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},n.methodFactory=a||U,n.getLevel=function(){return b??$??A},n.setLevel=function(l,s){return b=F(l),s!==!1&&Y(b),v.call(n)},n.setDefaultLevel=function(l){$=F(l),O()||n.setLevel(l,!1)},n.resetLevel=function(){b=null,q(),v.call(n)},n.enableAll=function(l){n.setLevel(n.levels.TRACE,l)},n.disableAll=function(l){n.setLevel(n.levels.SILENT,l)},n.rebuild=function(){if(i!==n&&(A=F(i.getLevel())),v.call(n),i===n)for(var l in g)g[l].rebuild()},A=F(i?i.getLevel():"WARN");var P=O();P!=null&&(b=F(P)),v.call(n)}i=new k,i.getLogger=function(a){if(typeof a!="symbol"&&typeof a!="string"||a==="")throw new TypeError("You must supply a name when creating a logger.");var n=g[a];return n||(n=g[a]=new k(a,i.methodFactory)),n};var S=typeof window!==o?window.log:void 0;return i.noConflict=function(){return typeof window!==o&&window.log===i&&(window.log=S),i},i.getLoggers=function(){return g},i.default=i,i})})(x);var G=x.exports;const c=D(G),M={level:"info",prefix:"[Backlog Enhancement]",timestamp:!0},w={boardAccordion:"error",issuePending:"error",shortcutKeys:"error",storage:"error",backlog:"error",background:"error",options:"error",content:"error"},I=new Map;function K(e){c.setLevel(e)}function h(e,t){const o=I.get(e);o&&o.setLevel(t),w[e]=t}function N(e){return w[e]||"info"}function j(){return{...w}}function W(e){const t=I.get(e);if(t)return t;const o=c.getLogger(e),p=w[e]||"info";o.setLevel(p);const y=o.methodFactory;return o.methodFactory=function(g,i,L){const m=y(g,i,L);return function(...E){const v=`[${new Date().toISOString()}]`,T=`${M.prefix}`,U=`[${g.toUpperCase()}]`,k=`[${e.charAt(0).toUpperCase()+e.slice(1)}]`,S=[`${v} ${T} ${U} ${k}`,...E].filter(Boolean);m(...S)}},o.setLevel(o.getLevel()),I.set(e,o),o}function C(){if(typeof window>"u"||typeof chrome>"u")return!0;try{return window.location.hostname==="localhost"||window.location.hostname.includes("dev")||chrome.runtime.getManifest().version.includes("dev")}catch{return!0}}function z(e){const t=c.methodFactory;c.methodFactory=function(o,p,y){const g=t(o,p,y);return function(...i){const L=e.timestamp?`[${new Date().toISOString()}]`:"",m=e.prefix?`${e.prefix}`:"",E=`[${o.toUpperCase()}]`,v=[`${L} ${m} ${E}`,...i].filter(Boolean);g(...v)}},c.setLevel(c.getLevel())}function V(e){const t={...M,...e};C()?t.level="debug":t.level="warn",z(t),K(t.level),c.info("Logger initialized",{level:t.level,isDev:C()})}function f(e){const t=W(e);return{debug:(...o)=>t.debug(...o),info:(...o)=>t.info(...o),warn:(...o)=>t.warn(...o),error:(...o)=>t.error(...o)}}const d={debug:(...e)=>c.debug(...e),info:(...e)=>c.info(...e),warn:(...e)=>c.warn(...e),error:(...e)=>c.error(...e),boardAccordion:f("boardAccordion"),issuePending:f("issuePending"),shortcutKeys:f("shortcutKeys"),storage:f("storage"),backlog:f("backlog"),background:f("background"),options:f("options"),content:f("content"),popup:f("popup")},J={setLevel:h,getLevel:N,showAll:()=>{console.table(j())},enable:e=>{h(e,"debug"),console.log(`✅ ${e} logging enabled (debug level)`)},disable:e=>{h(e,"silent"),console.log(`❌ ${e} logging disabled`)},enableAll:()=>{Object.keys(w).forEach(e=>{h(e,"debug")}),console.log("✅ All feature logging enabled")},disableAll:()=>{Object.keys(w).forEach(e=>{h(e,"error")}),console.log("❌ All feature logging disabled (error only)")}};typeof window<"u"&&C()&&(window.__backlogLoggerControl__=J),V(),chrome.runtime.onInstalled.addListener(e=>{d.info("Backlog Usability Enhance installed:",e.reason),e.reason==="install"?d.info("First time installation"):e.reason==="update"&&d.info("Extension updated")}),chrome.runtime.onStartup.addListener(()=>{d.info("Backlog Usability Enhance started")}),chrome.runtime.onMessage.addListener((e,t,o)=>{var p;switch(d.debug("Message received in background:",e),(e==null?void 0:e.type)??""){case"GET_TAB_INFO":(p=t.tab)!=null&&p.id&&o({tabId:t.tab.id,url:t.tab.url,title:t.tab.title});break;default:d.warn("Unknown message type:",e==null?void 0:e.type),o({error:"Unknown message type"})}return!0}),chrome.tabs.onUpdated.addListener((e,t,o)=>{t.status==="complete"&&o.url&&(o.url.includes(".backlog.jp")||o.url.includes(".backlog.com"))&&d.info("Backlog page loaded:",o.url)}),chrome.storage.onChanged.addListener((e,t)=>{d.debug("Storage changed:",{changes:e,areaName:t}),t==="sync"&&e.backlog_usability_enhance_settings&&d.info("Settings updated:",e.backlog_usability_enhance_settings.newValue)})})();
