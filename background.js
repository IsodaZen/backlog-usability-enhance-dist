(function(){"use strict";var P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function D(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var x={exports:{}};(function(e){(function(n,o){e.exports?e.exports=o():n.log=o()})(P,function(){var n=function(){},o="undefined",p=typeof window!==o&&typeof window.navigator!==o&&/Trident\/|MSIE /.test(window.navigator.userAgent),y=["trace","debug","info","warn","error"],g={},i=null;function L(r,a){var t=r[a];if(typeof t.bind=="function")return t.bind(r);try{return Function.prototype.bind.call(t,r)}catch{return function(){return Function.prototype.apply.apply(t,[r,arguments])}}}function m(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function E(r){return r==="debug"&&(r="log"),typeof console===o?!1:r==="trace"&&p?m:console[r]!==void 0?L(console,r):console.log!==void 0?L(console,"log"):n}function v(){for(var r=this.getLevel(),a=0;a<y.length;a++){var t=y[a];this[t]=a<r?n:this.methodFactory(t,r,this.name)}if(this.log=this.debug,typeof console===o&&r<this.levels.SILENT)return"No console available for logging"}function C(r){return function(){typeof console!==o&&(v.call(this),this[r].apply(this,arguments))}}function U(r,a,t){return E(r)||C.apply(this,arguments)}function A(r,a){var t=this,I,$,h,u="loglevel";typeof r=="string"?u+=":"+r:typeof r=="symbol"&&(u=void 0);function q(l){var c=(y[l]||"silent").toUpperCase();if(!(typeof window===o||!u)){try{window.localStorage[u]=c;return}catch{}try{window.document.cookie=encodeURIComponent(u)+"="+c+";"}catch{}}}function R(){var l;if(!(typeof window===o||!u)){try{l=window.localStorage[u]}catch{}if(typeof l===o)try{var c=window.document.cookie,k=encodeURIComponent(u),B=c.indexOf(k+"=");B!==-1&&(l=/^([^;]+)/.exec(c.slice(B+k.length+1))[1])}catch{}return t.levels[l]===void 0&&(l=void 0),l}}function H(){if(!(typeof window===o||!u)){try{window.localStorage.removeItem(u)}catch{}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function F(l){var c=l;if(typeof c=="string"&&t.levels[c.toUpperCase()]!==void 0&&(c=t.levels[c.toUpperCase()]),typeof c=="number"&&c>=0&&c<=t.levels.SILENT)return c;throw new TypeError("log.setLevel() called with invalid level: "+l)}t.name=r,t.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},t.methodFactory=a||U,t.getLevel=function(){return h??$??I},t.setLevel=function(l,c){return h=F(l),c!==!1&&q(h),v.call(t)},t.setDefaultLevel=function(l){$=F(l),R()||t.setLevel(l,!1)},t.resetLevel=function(){h=null,H(),v.call(t)},t.enableAll=function(l){t.setLevel(t.levels.TRACE,l)},t.disableAll=function(l){t.setLevel(t.levels.SILENT,l)},t.rebuild=function(){if(i!==t&&(I=F(i.getLevel())),v.call(t),i===t)for(var l in g)g[l].rebuild()},I=F(i?i.getLevel():"WARN");var M=R();M!=null&&(h=F(M)),v.call(t)}i=new A,i.getLogger=function(a){if(typeof a!="symbol"&&typeof a!="string"||a==="")throw new TypeError("You must supply a name when creating a logger.");var t=g[a];return t||(t=g[a]=new A(a,i.methodFactory)),t};var S=typeof window!==o?window.log:void 0;return i.noConflict=function(){return typeof window!==o&&window.log===i&&(window.log=S),i},i.getLoggers=function(){return g},i.default=i,i})})(x);var N=x.exports;const s=D(N),O={level:"error",prefix:"[Backlog Enhancement]",timestamp:!0},w={},_=new Map;function G(e){s.setLevel(e)}function b(e,n){const o=_.get(e);o&&o.setLevel(n),w[e]=n}function W(e){return w[e]||"info"}function j(){return{...w}}function K(e){switch(e){case s.levels.DEBUG:return"debug";case s.levels.INFO:return"info";case s.levels.WARN:return"warn";case s.levels.ERROR:return"error";case s.levels.SILENT:return"silent";default:return"info"}}function z(e){const n=_.get(e);if(n)return n;const o=s.getLogger(e),p=w[e]||K(s.getLevel());o.setLevel(p);const y=o.methodFactory;return o.methodFactory=function(g,i,L){const m=y(g,i,L);return function(...E){const v=`[${new Date().toISOString()}]`,C=`${O.prefix}`,U=`[${g.toUpperCase()}]`,A=`[${e.charAt(0).toUpperCase()+e.slice(1)}]`,S=[`${v} ${C} ${U} ${A}`,...E].filter(Boolean);m(...S)}},o.setLevel(o.getLevel()),_.set(e,o),o}function T(){if(typeof window>"u"||typeof chrome>"u")return!0;try{return window.location.hostname==="localhost"||window.location.hostname.includes("dev")||chrome.runtime.getManifest().version.includes("dev")}catch{return!0}}function V(e){const n=s.methodFactory;s.methodFactory=function(o,p,y){const g=n(o,p,y);return function(...i){const L=e.timestamp?`[${new Date().toISOString()}]`:"",m=e.prefix?`${e.prefix}`:"",E=`[${o.toUpperCase()}]`,v=[`${L} ${m} ${E}`,...i].filter(Boolean);g(...v)}},s.setLevel(s.getLevel())}function J(e){const n={...O,...e};T()?n.level="debug":n.level="warn",V(n),G(n.level),s.info("Logger initialized",{level:n.level,isDev:T()})}function f(e){const n=z(e);return{debug:(...o)=>n.debug(...o),info:(...o)=>n.info(...o),warn:(...o)=>n.warn(...o),error:(...o)=>n.error(...o)}}const d={debug:(...e)=>s.debug(...e),info:(...e)=>s.info(...e),warn:(...e)=>s.warn(...e),error:(...e)=>s.error(...e),boardAccordion:f("boardAccordion"),issuePending:f("issuePending"),shortcutKeys:f("shortcutKeys"),storage:f("storage"),backlog:f("backlog"),background:f("background"),options:f("options"),content:f("content"),popup:f("popup")},Y={setLevel:b,getLevel:W,showAll:()=>{console.table(j())},enable:e=>{b(e,"debug"),console.log(`✅ ${e} logging enabled (debug level)`)},disable:e=>{b(e,"silent"),console.log(`❌ ${e} logging disabled`)},enableAll:()=>{Object.keys(w).forEach(e=>{b(e,"debug")}),console.log("✅ All feature logging enabled")},disableAll:()=>{Object.keys(w).forEach(e=>{b(e,"error")}),console.log("❌ All feature logging disabled (error only)")}};typeof window<"u"&&T()&&(window.__backlogLoggerControl__=Y),J(),chrome.runtime.onInstalled.addListener(e=>{d.info("Backlog Usability Enhance installed:",e.reason),e.reason==="install"?d.info("First time installation"):e.reason==="update"&&d.info("Extension updated")}),chrome.runtime.onStartup.addListener(()=>{d.info("Backlog Usability Enhance started")}),chrome.runtime.onMessage.addListener((e,n,o)=>{var p;switch(d.debug("Message received in background:",e),(e==null?void 0:e.type)??""){case"GET_TAB_INFO":(p=n.tab)!=null&&p.id&&o({tabId:n.tab.id,url:n.tab.url,title:n.tab.title});break;default:d.warn("Unknown message type:",e==null?void 0:e.type),o({error:"Unknown message type"})}return!0}),chrome.tabs.onUpdated.addListener((e,n,o)=>{n.status==="complete"&&o.url&&(o.url.includes(".backlog.jp")||o.url.includes(".backlog.com"))&&d.info("Backlog page loaded:",o.url)}),chrome.storage.onChanged.addListener((e,n)=>{d.debug("Storage changed:",{changes:e,areaName:n}),n==="sync"&&e.backlog_usability_enhance_settings&&d.info("Settings updated:",e.backlog_usability_enhance_settings.newValue)})})();
