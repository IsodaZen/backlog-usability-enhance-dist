var g=Object.defineProperty;var r=(i,e,t)=>e in i?g(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var a=(i,e,t)=>r(i,typeof e!="symbol"?e+"":e,t);import{D as c,S as o}from"../assets/storage.js";import{l as n}from"../assets/logger.js";class u{constructor(){a(this,"settings",c);this.init()}async init(){try{await this.loadSettings(),this.updateUI(),this.setupEventListeners(),n.info("Options page initialized")}catch(e){n.error("Failed to initialize options page:",e)}}async loadSettings(){this.settings=await o.getSettings(),n.debug("Settings loaded:",this.settings)}updateUI(){const e=document.getElementById("boardAccordionEnabled");e&&(e.checked=this.settings.boardAccordion.enabled);const t=document.getElementById("shortcutKeysEnabled");t&&(t.checked=this.settings.shortcutKeys.enabled);const s=document.getElementById("issuePendingEnabled"),d=document.getElementById("issuePendingAutoResolve");s&&(s.checked=this.settings.issuePending.enabled),d&&(d.checked=this.settings.issuePending.autoResolve),this.updateSubSettingsState()}updateSubSettingsState(){const e=document.getElementById("issuePendingEnabled"),t=document.getElementById("issuePendingAutoResolve");e&&t&&(t.disabled=!e.checked,t.parentElement.style.opacity=e.checked?"1":"0.5")}setupEventListeners(){const e=document.getElementById("resetButton");e&&e.addEventListener("click",()=>this.resetSettings()),document.querySelectorAll('input[type="checkbox"]').forEach(s=>{s.addEventListener("change",()=>{this.onSettingChanged(),this.updateSubSettingsState()})})}async onSettingChanged(){this.updateSettingsFromUI(),await this.saveSettingsImmediate()}updateSettingsFromUI(){const e=document.getElementById("boardAccordionEnabled");e&&(this.settings.boardAccordion.enabled=e.checked);const t=document.getElementById("shortcutKeysEnabled");t&&(this.settings.shortcutKeys.enabled=t.checked);const s=document.getElementById("issuePendingEnabled"),d=document.getElementById("issuePendingAutoResolve");s&&(this.settings.issuePending.enabled=s.checked),d&&(this.settings.issuePending.autoResolve=d.checked)}async saveSettingsImmediate(){try{await o.saveSettings(this.settings),n.info("Settings saved immediately:",this.settings)}catch(e){n.error("Failed to save settings immediately:",e)}}async resetSettings(){try{if(!confirm("設定をデフォルトに戻しますか？"))return;this.settings={...c},this.updateUI(),await o.saveSettings(this.settings),n.info("Settings reset to default")}catch(e){n.error("Failed to reset settings:",e)}}}document.addEventListener("DOMContentLoaded",()=>{new u});
